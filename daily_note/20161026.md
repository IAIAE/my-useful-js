#redux的middleware(接着昨天的写)
redux中的middleware是位于用户触发store.dispatch(action)到action到达reducer之前的过程。

如果我们要为每一个action加一个log。会怎样加呢？一种最粗暴的办法是：
```javascript
var dispatch = store.dispatch;
store.dispatch = action => {
    console.info(action);
    return dispatch(action);
}
```
这叫做猴子补丁。

为了避免这种猴子补丁，并且不显式地更改store.dispatch。一种办法是将dispatch当做参数传给一个middleware.

```javascript
var applyMiddleware = (...middlewares) => store => {
    middlewares = middleware.reverse();
    var next = store.dispatch;
    _.each(middlewares, middleware => {
        next = middleware(store.getState, store.dispatch)(next);
    });
    return {...store, next};
};

//对于一个middleware
var aMiddleware = (getState, dispatch) => next => action => {
    // do something with action
    // such as action = Object.assign({}, action, message:'add by middleware');
    // then
    // the next middleware will recieve the new action.
    return next(action);  
    // and the result returned by next middleware will return by this one.
}
```


OK!!!!
